#cloud-config

hostname: mpislave 

users:
  - default
  - name: lgerber
    gecos: lorenz gerber
    groups: sudo
    shell: /bin/bash
    sudo: ['ALL=(ALL) NOPASSWD:ALL']
    ssh-authorized-keys:
      ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQDSp//sJGpRm0SOAzz/25WkfZENW5iOQqmDNcwaPnsdyuP2IzT46uOC1BgvEGdnFaLi+JiGtMP9cEU0BtEpD8GEWXFoolNEZNT39kL9kl20kt5pCLWxSpDMeYAD6d5nu9284QOfla9O6l4WSJsyEmF0PcFVF3ZzpdRU2gtEVZ1I3hwpEeU553vgPm0/MAAuYK9987jmJlrY8ubgZQ2vdZCUFuMizxM6gYbEXNKlj+HV1NopyXAcADHtc96waA870hHW37pHkJz9cAst2ElXSmNZveRAXxNQaKEwpJpFPJZifl/cgh2rIsiWWRZsy4Au+ykO4/2TPLvZF8061cMPabLPYXHl00NR/+GosmzDyeD98ARNF+TSZ4DQboqgITsamkIvTswMep1JpwtAoT7jQv7CIGugB7j0HGYWsWpAUhG4NH+Ktc+9ZZKboHJyMAv6UHOdLfNAMlRgVvsJ64JvMJquo0utpseqwzuNMpsMEmfBqk3ZXZ0mMm2JT0JuEbcgu3rxBxjhsWMfa9M4wRh2DEDEfEtgJ+n98NDJEOi1RbawyFHW1UDV+9hzKmqRNsb33Qe6XH+94mls33RV5SrBCo9qIJsgAd/U5w+0XDbLoZe8SqQc4QT5o4k5hO58A6lw9kUy3IRhNBkuHzIUVSBShXI4nbRDMYDBP9XOEoXyIEldAQ== lorenzottogerber@gmail.com

runcmd:
  -  'sudo apt-get update'
  -  'sudo apt-get -y install apt-transport-https ca-certificates curl software-properties-common'
  -  'curl -fsSL "https://download.docker.com/linux/ubuntu/gpg" | sudo apt-key add -'
  -  'sudo add-apt-repository "deb [arch=amd64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable"'
  -  'sudo apt-get update'
  -  'sudo apt-get -y install docker-ce'
  -  'sudo usermod -aG docker lgerber'
  -  'sudo apt-get -y install python dh-autoreconf build-essential'
  -  'cd /home/lgerber' 
  -  'git clone https://github.com/singularityware/singularity.git'
  -  'cd singularity'
  -  './autogen.sh'
  -  './configure --prefix=/usr/local --sysconfdir=/etc'
  -  'make'
  -  'sudo make install'
